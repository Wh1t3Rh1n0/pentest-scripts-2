# pentest-scripts-2

*More miscellaneous, one-off scripts I created while red-teaming and pentesting.*

> This README is automatically generated by <code>generate-readme.sh</code>.

---

## merge-hashcat.py

```
merge-hashcat.py
----------------
Matches passwords cracked with hashcat to their usernames.

Usage: merge-hashcat.py <user:hash file> <hash:password file>

Notes: The "hash:password" file is created by hashcat's -o option.

       The "user:hash" file is easy to create using your original hashdump and
       the "cut" command. An example of creating this file from hashes dumped
       from a Windows domain controller follows:
       
       cat raw_dump.txt | cut -d ':' -f 1,4 > dumped-users_hashes.txt

```

## trufflehog-json2csv.py

```
trufflehog-json2csv.py - by Wh1t3Rh1n0
----------------------

Converts TruffleHog JSON output to a CSV file.

Usage: ./trufflehog-json2csv.py <INPUT FILE> <OUTPUT FILE> [Excluded file extensions]

Example:

    ./trufflehog-json2csv.py trufflehog.json output.csv .dll .exe .png .jpg

TruffleHog command used to generate the JSON file referenced above:

    ./trufflehog filesystem --json $PWD/input-files/ | tee trufflehog.json


```

## analyze-user_pass.sh

```
Simple password analysis - user:password edition // by Wh1t3Rh1n0
================================================ //    2023-12-11

Takes a colon-separated list of usernames and passwords (e.g., Hashcat output)
and returns lists of users whose passwords matched certain criteria or
weaknesses.

The list of affected usernames (but NOT passwords) is returned as output, so
the list can be safely provided to customers without disclosing users'
passwords, and specific remediation actions can be taken.

Currently checks:
- Password length
- Passwords containing common keywords

Usage:
------
./analyze-user_pass.sh <user:password file> <output dir> [company name regex]

Note that the regex is optional and case insensitive.

Example:
--------
./analyze-user_pass.sh cracked.txt 'Password analysis' 'Dewey|Cheatem|Howe|DCH'

```

## generate-readme.sh

```
This script generates the README.md file for this repository.
```

