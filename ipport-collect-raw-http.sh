if [ ! -e "$1" ] ; then
    cat <<EOF

ipport-collect-raw-http.sh
==========================

Retrieves HTTP/HTTPS (whichever works) headers and content from a webserver and
saves the output in a IP_PORT-named file inside the folder, 'output.raw-http'.

Usage: bash ipport-collect-raw-http.sh <IP:Port list>

Useful for doing stuff like grabbing version numbers from the headers/body of
a lot of web servers all at once.

Example:

    bash ipport-collect-raw-http.sh webservers.txt
    cd output.raw-http
    grep -i '< server' *
EOF
    exit
fi

outdir=output.raw-http
mkdir $outdir

for ipport in $(cat "$1") ; do

safename=$(echo $ipport | tr ':' '_')

curl -vks --connect-timeout 2 "http://$ipport" > $outdir/$safename 2>&1
curl -vks --connect-timeout 2 "https://$ipport" >> $outdir/$safename 2>&1

done
