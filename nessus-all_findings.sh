#!/bin/bash

if [ ! -e "$1" ] ; then
cat <<EOF

This script outputs ALL the findings from a Nessus CSV file into a slightly
more readable/greppable format.

Output is CSV with semicolons as field delimiters. Columns output are:

Severity ; Issue ; Protocol ; Host ; Port

Outputs to stdout.

Usage: ./nessus-all_findings.sh <NESSUS CSV FILE> > <OUTPUT FILE>

EOF
exit ; fi


echo "Severity;Issue;Protocol;Host;Port" ; grep -E '^"[0-9]+' "$1" | awk -F '","' '{ print $4 ";" $8 ";" $6 ";" $5 ";" $7}' | sort -u
